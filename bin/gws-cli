#!/usr/bin/env node
"use strict";

let inquirer = require('inquirer');
let fs = require('fs');

const cwd = process.cwd();
console.log(cwd);
console.log(__dirname);
console.log(__filename);

// /Users/xiayuting/workBase/gws
// /Users/xiayuting/workBase/gws/bin
// /Users/xiayuting/workBase/gws/bin/gws-cli

/*
let name = process.argv[2];
let exec = require("child_process").exec;

let child = exec("echo hello " + name, function(err, stdout, stderr) {
  if (err) throw err;
  console.log(stdout);
});
*/

const promptList = [{
  type: 'input',
  message: '项目名称:',
  name: 'name',
  default: "myProject" // 默认值
},{
  type: 'input',
  message: '描述:',
  name: 'description',
  default: "" // 默认值
},{
  type: 'list',
  message: '模式选择:',
  name: 'pattern',
  choices: [
    "Simple",
    "Base"
  ],
  filter: function (val) { // 使用filter将回答变为小写
    return val.toLowerCase();
  }
}];

inquirer.prompt(promptList).then(answers => {
  console.log(answers); // 返回的结果

  // 写入文件内容（如果文件不存在会创建一个文件）
  // 写入时会先清空文件
  fs.writeFile(`${cwd}/package.json`, JSON.stringify(answers), function(err) {
    if (err) {
      throw err;
    }

    // 写入成功后读取测试
    fs.readFile(`${cwd}/package.json`, 'utf-8', function(err, data) {
      if (err) {
        throw err;
      }
      console.log('生成文件：', JSON.parse(data));
    });
  });
});
